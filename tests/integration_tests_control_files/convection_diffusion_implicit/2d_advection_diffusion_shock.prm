# Listing of Parameters
# ---------------------
# Number of dimensions
set dimension = 2

# The PDE we want to solve. Choices are
# <advection|diffusion|convection_diffusion>.
set pde_type  = advection #convection_diffusion
set test_type = grid_refinement_study

subsection linear solver
#set linear_solver_type = direct
  subsection gmres options
    set linear_residual_tolerance = 1e-4
    set max_iterations = 2000
    set restart_number = 50
    set ilut_fill = 1
    # set ilut_drop = 1e-4
  end 
end

subsection ODE solver
  # Maximum nonlinear solver iterations
  set nonlinear_max_iterations            = 500

  # Nonlinear solver residual tolerance
  set nonlinear_steady_residual_tolerance = 1e-12

  # Print every print_iteration_modulo iterations of the nonlinear solver
  set print_iteration_modulo              = 1

  # Explicit or implicit solverChoices are <explicit|implicit>.
  set ode_solver_type                         = implicit
end

subsection grid refinement study
  # polyonomial degrees
  set poly_degree      = 1
  set poly_degree_max  = 4
  set poly_degree_grid = 1

  # grid setup
  set grid_type  = hypercube
  #set input_grid = NaN
  set grid_left  = 0.0
  set grid_right = 1.0
  set grid_size  = 4

  # manufactured solution
  #set use_manufactured_source_term = true
  #set manufactured_solution_type   = atan_solution

  # functional
  subsection functional
    # functional choice
    set functional_type = error_normLp_volume

    # Lp norm parameters
    set normLp          = 2.0

    # weighted integral parameters
    #set weight_function_type          = sine_solution
    #set use_weight_function_laplacian = true

    # boundary functional parameters
    #set boundary_vector    = [0]
    #set use_all_boundaries = true
  end

  # number of refinements
  set num_refinements = 3

  # grid refinement - 0
  subsection grid refinement [0]
    set refinement_steps  = 6
    set refinement_method = uniform
  end

  # grid refinement - 1
  subsection grid refinement [1]
    set refinement_steps    = 9
    set refinement_method   = fixed_fraction
    set refinement_type     = h
    set isotropic           = true
    set error_indicator     = hessian_based
    set norm_Lq             = 2.0
    set refinement_fraction = 0.3
    set coarsening_fraction = 0.00
    set complexity_scale    = 2.0
    set complexity_add      = 0.0
  end

  subsection grid refinement [2]
    set refinement_steps    = 8
    set refinement_method   = continuous
    set refinement_type     = h
    set isotropic           = true
    set error_indicator     = hessian_based
    set norm_Lq             = 2.0
    set complexity_scale    = 2.0
    set complexity_add      = 0.0
  end
end

subsection manufactured solution convergence study
  set use_manufactured_source_term = true
  set manufactured_solution_type   = boundary_layer_solution
end

